<VirtualHost *:8080>
    ServerName localhost

    AllowEncodedSlashes NoDecode

    # Pass through original host/proto from outer reverse proxy.
    ProxyPreserveHost On

    # SvnHub UI (Kestrel) lives on localhost:5000 inside the container.
    ProxyPass        /svn !
    ProxyPass        / http://127.0.0.1:5000/
    ProxyPassReverse / http://127.0.0.1:5000/

    # Subversion (mod_dav_svn) in the same Apache instance.
    <Location /svn>
        DAV svn
        SVNParentPath /var/lib/svnhub/repos
        LimitRequestBody 0

        AuthType Basic
        AuthName "Subversion"
        AuthUserFile /var/lib/svnhub/data/htpasswd

        AuthzSVNAccessFile /var/lib/svnhub/data/authz
        Require valid-user
    </Location>
</VirtualHost>
