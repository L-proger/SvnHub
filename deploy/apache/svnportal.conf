# Example Apache2 config (Ubuntu) for SvnHub + Subversion (mod_dav_svn)
#
# Assumptions:
# - SvnHub runs on http://127.0.0.1:5000
# - SVN repositories are under /srv/svn/repos
# - auth files are /etc/svn/htpasswd and /etc/svn/authz (generated by SvnHub)
#
# Enable modules:
#   a2enmod dav dav_svn authz_svn proxy proxy_http headers ssl

<VirtualHost *:443>
    ServerName svn.example.com

    SSLEngine on
    # SSLCertificateFile /etc/letsencrypt/live/svn.example.com/fullchain.pem
    # SSLCertificateKeyFile /etc/letsencrypt/live/svn.example.com/privkey.pem

    # Reverse proxy to SvnHub UI
    ProxyPreserveHost On
    RequestHeader set X-Forwarded-Proto "https"
    ProxyPass        / http://127.0.0.1:5000/
    ProxyPassReverse / http://127.0.0.1:5000/

    # Subversion over HTTPS
    <Location /svn>
        DAV svn
        SVNParentPath /srv/svn/repos

        AuthType Basic
        AuthName "Subversion"
        AuthUserFile /etc/svn/htpasswd

        AuthzSVNAccessFile /etc/svn/authz

        Require valid-user
    </Location>
</VirtualHost>

